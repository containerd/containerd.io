{{- $currentUrl := .RelPermalink }}
{{- $xVersion := index (findRE `v\d+\.\d+\.x` .RelPermalink) 0 }}
{{- $docs := where site.RegularPages "CurrentSection.Path" "like" (printf "%s%s%s" "/docs/" $xVersion ".*") }}

<div class="dropdown">
  <div class="dropdown-trigger">
    <button class="button is-dark" aria-haspopup="true" aria-controls="docs-dropdown-menu">
      <span>Docs</span>
      <span class="icon is-small">
        <i class="fas fa-angle-down" aria-hidden="true"></i>
      </span>
    </button>
  </div>
  <div class="dropdown-menu" id="docs-dropdown-menu" role="menu">
    <div class="dropdown-content">
      <a class="dropdown-item{{ if eq .RelPermalink `/docs/` }} is-active{{ end }}" href="/docs">
        Docs Home
      </a>

      {{ if (strings.Contains $xVersion "v") }}
      {{- $readmeURL := (printf "%s%s%s" "/docs/" $xVersion "/") }}
      <a href="{{$readmeURL}}" class="dropdown-item{{ if eq .RelPermalink $readmeURL }} is-active{{ end }}">
          README
      </a>
      {{ end }}

      {{- range $docs }}
      {{- $isCurrentPage := eq $currentUrl .RelPermalink }}
      <a class="dropdown-item{{ if $isCurrentPage }} is-active{{ end }}" href="{{ .RelPermalink }}">
        {{ cond (eq .Title "") (.File.BaseFileName | humanize | title) .Title }}
      </a>
      {{- end }}
    </div>
  </div>
</div>

{{- if .TableOfContents }}
<div class="dropdown">
  <div class="drodown-trigger">
    <button class="button is-light">
      <span>
        Contents
      </span>
      <span class="icon is-small">
        <i class="fas fa-angle-down" aria-hidden="true"></i>
      </span>
    </button>
  </div>
  <div class="dropdown-menu">
    <div class="dropdown-content is-dropdown-toc">
      {{ .TableOfContents }}
    </div>
  </div>
</div>
{{- end }}

<hr>
